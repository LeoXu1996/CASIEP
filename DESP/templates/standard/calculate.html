<!DOCTYPE html>
{% load static %}
<html lang="en" class="loading">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta name="description"
          content="Convex admin is super flexible, powerful, clean &amp; modern responsive bootstrap 4 admin template with unlimited possibilities.">
    <meta name="keywords"
          content="admin template, Convex admin template, dashboard template, flat admin template, responsive admin template, web app">
    <meta name="author" content="PIXINVENT">
    <title>Page for calculate</title>
    <link rel="apple-touch-icon" sizes="60x60" href="{% static 'app-assets/img/ico/apple-icon-60.png' %}">
    <link rel="apple-touch-icon" sizes="76x76" href="{% static 'app-assets/img/ico/apple-icon-76.png' %}">
    <link rel="apple-touch-icon" sizes="120x120" href="{% static 'app-assets/img/ico/apple-icon-120.png' %}">
    <link rel="apple-touch-icon" sizes="152x152" href="{% static 'app-assets/img/ico/apple-icon-152.png' %}">
    <link rel="shortcut icon" type="image/x-icon" href="{% static 'app-assets/img/ico/favicon.ico' %}">
    <link rel="shortcut icon" type="image/png" href="{% static 'app-assets/img/ico/favicon-32.png' %}">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/fonts/feather/style.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/fonts/simple-line-icons/style.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/fonts/font-awesome/css/font-awesome.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/perfect-scrollbar.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/prism.min.css' %}">
    <link rel="stylesheet" type="text/css"
          href="{% static 'app-assets/vendors/css/tables/datatable/datatables.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/app.css' %}">
    <link rel="stylesheet" href="{% static 'layui/css/layui.css' %}">

</head>
<body data-col="2-columns" class=" 2-columns ">

<!--modals begin-->
<!--add-->

<!-- Edit Index -->

<!-- ////////////////////////////////////////////////////////////////////////////-->
<!--modals end-->
<div class="wrapper nav-collapsed menu-collapsed">

    <div data-active-color="white" data-background-color="primary" data-image="" class="app-sidebar">
        <div class="sidebar-header">
            <div class="logo clearfix"><a href="{% url 'administrator' %}" class="logo-text float-left">
                <div class="logo-img"><img src="{% static 'app-assets/img/logo.png' %}" alt="Convex Logo"/></div>
                <span class="text align-middle">CNIC</span></a><a id="sidebarToggle" href="javascript:;"
                                                                  class="nav-toggle d-none d-sm-none d-md-none d-lg-block"><i
                    data-toggle="collapsed" class="ft-circle toggle-icon"></i></a><a id="sidebarClose"
                                                                                     href="javascript:;"
                                                                                     class="nav-close d-block d-md-block d-lg-none d-xl-none"><i
                    class="ft-circle"></i></a></div>
        </div>
        <div class="sidebar-content">
            <div class="nav-container">
                <ul id="main-menu-navigation" data-menu="menu-navigation" class="navigation navigation-main">
                    <li class="has-sub nav-item"><a href="#"><i class="ft-menu"></i><span
                            data-i18n=""
                            class="menu-title">项目管理</span></a>
                        <ul class="menu-content">
                            {% for u in evalname %}
                                <li>
                                    <a href="{% url 'standard' %}?evalname={{ u.table_evaluation_col_name }}&admin={{ admin }}"
                                       class="menu-item">{{ u.table_evaluation_col_name }}</a>
                                </li>
                            {% endfor %}
                        </ul>
                    </li>

                    <li class="has-sub nav-item"><a href="#"><i class="icon-calendar"></i><span
                            data-i18n=""
                            class="menu-title">项目进度</span></a>
                        <ul class="menu-content">
                            {% for t in evalname %}
                                <li>
                                    <a href="{% url 'timeliner' %}?timeevalname={{ t.table_evaluation_col_name }}&admin={{ admin }}"
                                       class="menu-item">{{ t.table_evaluation_col_name }}</a>
                                </li>
                            {% endfor %}
                        </ul>
                    </li>

                    <li class="has-sub nav-item"><a href="#"><i class="ft-file-text"></i><span
                            data-i18n=""
                            class="menu-title">数据采集</span></a>
                        <ul class="menu-content">
                            <li><a href="{% url 'questionaire_manage' %}" class="menu-item">问卷管理</a></li>
                        </ul>
                    </li>

                    <li class="has-sub nav-item"><a href="#"><i class="icon-calendar"></i><span
                            data-i18n=""
                            class="menu-title">数据统计</span></a>
                        <ul class="menu-content">
                            {% for t in evalname %}
                                <li>
                                    <a href="{% url 'calculate' %}?timeevalname={{ t.table_evaluation_col_name }}&admin={{ admin }}"
                                       class="menu-item">{{ t.table_evaluation_col_name }}</a>
                                </li>
                            {% endfor %}
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
        <div class="sidebar-background"></div>
    </div>


    <nav class="navbar navbar-expand-lg navbar-light bg-faded">
        <div class="container-fluid">
            <div class="navbar-header">

                <button type="button" data-toggle="collapse" class="navbar-toggle d-lg-none float-left"><span
                        class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span
                        class="icon-bar"></span><span class="icon-bar"></span></button>
                <span class="d-lg-none navbar-right navbar-collapse-toggle"><a class="open-navbar-container"><i
                        class="ft-more-vertical"></i></a></span><a id="navbar-fullscreen" href="javascript:;"
                                                                   class="mr-2 display-inline-block apptogglefullscreen"><i
                    class="ft-maximize blue-grey darken-4 toggleClass"></i>
                <p class="d-none">fullscreen</p></a>

            </div>
            <div class="navbar-container">
                <div id="navbarSupportedContent" class="collapse navbar-collapse">
                    <ul class="navbar-nav">
                        <li class="dropdown nav-item mr-0"><a id="dropdownBasic3" href="#" data-toggle="dropdown"
                                                              class="nav-link position-relative dropdown-user-link dropdown-toggle"><span
                                class="avatar avatar-online"><img id="navbar-avatar"
                                                                  src="{% static 'app-assets/img/portrait/small/avatar-s-3.jpg' %}"
                                                                  alt="avatar"/></span>
                            <p class="d-none">User Settings</p></a>
                            <div aria-labelledby="dropdownBasic3" class="dropdown-menu dropdown-menu-right">
                                <div class="arrow_box_right">
                                    <a href="{% url 'logout' %}" class="dropdown-item"><i
                                            class="ft-power mr-2"></i><span>Logout</span></a>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>


    <!--End of sidebar and navibar-->

    <div class="main-panel">
        <div class="main-content">
            <div class="content-wrapper">
                <div class="container-fluid"><!-- Base style table -->
                    <section id="base-style">
                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <div class="card-title-wrap bar-success">
                                            <fieldset class="layui-elem-field layui-field-title"
                                                      style="margin-top: 20px;">
                                                {% for t in timeline_list %}

                                                    <legend>{{ t.table_timeliner_col_evaluation }}</legend>
                                                {% endfor %}

                                            </fieldset>
                                        </div>
                                    </div>
                                    <div class="card-body collapse show">
                                        <div class="card-block card-dashboard">
                                            <p class="card-text"></p>
                                            <table class="table table-striped table-bordered base-style">
                                                <thead>
                                                <tr>
                                                    <th>评估体系</th>
                                                    <th>工作项目</th>
                                                    <th>工作状态</th>
                                                    <th>截止时间</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                {% for t in timeline_list %}
                                                    {% for x in org_eval %}
                                                        {% if x.table_evaluation_col_name == t.table_timeliner_col_evaluation %}
                                                            {% if x.table_evaluation_col_administrator == admin %}
                                                                <tr>
                                                                    <td>{{ x.table_evaluation_col_name }}</td>
                                                                    <td>{{ t.table_timeliner_col_content }}</td>
                                                                    <td>{{ t.table_timeliner_col_status }}</td>
                                                                    <td>{{ t.table_timeliner_col_end }}</td>
                                                                </tr>
                                                            {% endif %}
                                                        {% endif %}

                                                    {% endfor %}
                                                {% endfor %}
                                                </tbody>
                                            </table>
                                            <button type="button" class="layui-btn">合成总分</button>

                                            <fieldset class="layui-elem-field layui-field-title"
                                                      style="margin-top: 20px;">
                                                <legend>问卷填报进度</legend>
                                            </fieldset>
                                            <div class="layui-progress" lay-showpercent="true">
                                                <div class="layui-progress-bar" lay-percent="32/144"></div>
                                            </div>
                                            <button type="button" class="layui-btn">生成自动计分</button>

                                            <fieldset class="layui-elem-field layui-field-title"
                                                      style="margin-top: 20px;">
                                                <legend>专家打分进度</legend>
                                            </fieldset>
                                            <div class="layui-progress" lay-showpercent="true">
                                                <div class="layui-progress-bar" lay-percent="66/144"></div>
                                            </div>
                                            <button type="button" class="layui-btn">生成专家打分</button>

                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <!--/ Base style table -->
                </div>
            </div>
        </div>


        <div class="card">
            <!--	<div class="card-body">-->
            <!--		<div class="card-block">-->
            <!--			<section class="cd-horizontal-timeline">-->
            <!--				<div class="timeline">-->
            <!--					<div class="events-wrapper">-->
            <!--						<div class="events">-->
            <!--							<ol>-->
            <!--								<li><a data-date="01/04/2020" class="selected">时间线开始</a></li>-->
            <!--                                {% for date in dateline %}-->
                <!--                                <li><a data-date={{ date.table_timeliner_col_start }}>{{ date.table_timeliner_col_status }}</a></li>-->
                <!--                                {% endfor %}-->
            <!--							</ol>-->
            <!--							<span class="filling-line" aria-hidden="true"></span>-->
            <!--						</div>-->
            <!--						&lt;!&ndash; .events &ndash;&gt;-->
            <!--					</div>-->
            <!--					&lt;!&ndash; .events-wrapper &ndash;&gt;-->

            <!--					<ul class="cd-timeline-navigation">-->
            <!--						<li><a href="#0" class="prev inactive">Prev</a></li>-->
            <!--						<li><a href="#0" class="next">Next</a></li>-->
            <!--					</ul>-->
            <!--					&lt;!&ndash; .cd-timeline-navigation &ndash;&gt;-->
            <!--				</div>-->
            <!--				&lt;!&ndash; .timeline &ndash;&gt;-->

            <!--				<div class="events-content">-->
            <!--					<ol>-->
            <!--                        <li class="selected" data-date="01/04/2020">-->
            <!--							<h4 class="text-bold-500">选择查看工作进度</h4>-->
            <!--						</li>-->

            <!--                        {% for dateps in dateline %}-->
                <!--						<li data-date={{ dateps.table_timeliner_col_start }}>-->
                <!--							<h4 class="text-bold-500">{{ dateps.table_timeliner_col_name }}</h4>-->
                <!--							<h5 class="text-bold-500 mb-2">起始时间：{{ dateps.table_timeliner_col_start }}-->
                <!--                                &nbsp;&nbsp; 完成时间：{{ dateps.table_timeliner_col_end }}-->
                <!--                                &nbsp;&nbsp; 状态：{{ dateps.table_timeliner_col_status}}</h5>-->
                <!--							<p>-->
                <!--								{{ dateps.table_timeliner_col_content }}-->
                <!--							</p>-->
                <!--						</li>-->
                <!--                        {% endfor %}-->
            <!--					</ol>-->
            <!--				</div>-->
            <!--				&lt;!&ndash; .events-content &ndash;&gt;-->
            <!--			</section>-->
            <!--		</div>-->
            <!--	</div>-->
        </div>


        <footer class="footer footer-static footer-light">
            <p class="clearfix text-muted text-center px-2"><span>Copyright  &copy; CNIC <a href="#" id="pixinventLink"
                                                                                            target="_blank"
                                                                                            class="text-bold-800 primary darken-2"></a>, All rights reserved. </span>
            </p>
        </footer>
    </div>
</div>


<!-- ////////////////////////////////////////////////////////////////////////////-->


<script src="{% static 'layui/layui.js' %}" charset="utf-8"></script>

<script src="{% static 'app-assets/vendors/js/core/jquery-3.3.1.min.js' %}"></script>
<script src="{% static 'app-assets/vendors/js/core/popper.min.js' %}"></script>
<script src="{% static 'app-assets/vendors/js/core/bootstrap.min.js' %}"></script>
<script src="{% static 'app-assets/vendors/js/perfect-scrollbar.jquery.min.js' %}"></script>
<script src="{% static 'app-assets/vendors/js/prism.min.js' %}"></script>
<script src="{% static 'app-assets/vendors/js/jquery.matchHeight-min.js' %}"></script>
<script src="{% static 'app-assets/vendors/js/screenfull.min.js' %}"></script>
<script src="{% static 'app-assets/vendors/js/pace/pace.min.js' %}"></script>
<!-- BEGIN VENDOR JS-->
<!-- BEGIN PAGE VENDOR JS-->
<script src="{% static 'app-assets/vendors/js/datatable/datatables.min.js' %}"></script>
<!-- END PAGE VENDOR JS-->
<!-- BEGIN CONVEX JS-->
<script src="{% static 'app-assets/js/app-sidebar.js' %}"></script>
<script src="{% static 'app-assets/js/notification-sidebar.js' %}"></script>
<!-- END CONVEX JS-->
<!-- BEGIN PAGE LEVEL JS-->
<script src="{% static 'app-assets/js/data-tables/datatable-styling.js' %}"></script>
<script src="{% static 'app-assets/js/horizontal-timeline.js' %}"></script>
<script>
    function go(id) {
        itemid = id
    }

</script>


<script>
    function timeliner_edit(id) {
        itemid = id;
        $.ajax({
            type: 'GET',
            data: {
                'edit_id': itemid
            },
            url: "{% url "timeliner_edit" %}",
            dataType: 'json',
            success: function (data) {
                $("#edit_name").attr("value", eval("(" + data.timeline + ")")[0].fields.table_timeliner_col_name);
                $("#edit_content").val(eval("(" + data.timeline + ")")[0].fields.table_timeliner_col_content);
                $('#edit_start').attr("value", eval("(" + data.timeline + ")")[0].fields.table_timeliner_col_start);
                $('#edit_end').attr("value", eval("(" + data.timeline + ")")[0].fields.table_timeliner_col_end);
                $('#edit_status').attr("value", eval("(" + data.timeline + ")")[0].fields.table_timeliner_col_status);
            }

        });
        $('#mymodal_edit').modal('show');
    }

</script>

<script type="text/javascript">
    $(document).ready(function () {
        $.ajaxSetup({
            data: {csrfmiddlewaretoken: "{{ csrf_token }}"},
        });

        $("#CreateForm_Content").submit(function () {
            var create_name = $("#create_name").val();
            var create_content = $("#create_content").val();
            var create_start = $('#create_start').val();
            var create_end = $('#create_end').val();
            var create_status = $('#create_status').val();
            var create_eval = $('#create_eval').val();
            $.ajax({
                type: 'POST',
                data: {
                    "name": create_name,
                    "content": create_content,
                    'start': create_start,
                    'end': create_end,
                    'status': create_status,
                    'eval': create_eval
                },
                url: "{% url "timeliner_create" %}",
                cache: false,

                dataType: "json",

                success: function (data) {
                    window.location.reload();
                    alert(data.message);
                },
                error: function (data) {
                    alert(data.message);
                }
            });
            return false;
        });

        $("#EditForm_Content").submit(function (event) {
            event.preventDefault();

            var edit_id = itemid;
            var edit_name = $("#edit_name").val();
            var edit_content = $("#edit_content").val();
            var edit_start = $('#edit_start').val();
            var edit_end = $('#edit_end').val();
            var edit_status = $('#edit_status').val();
            $.ajax({
                type: 'POST',
                data: {
                    'edit_id': edit_id,
                    'edit_name': edit_name,
                    "content": edit_content,
                    'start': edit_start,
                    'end': edit_end,
                    'status': edit_status
                },
                async: false,
                url: "{% url "timeliner_edit" %}",
                cache: false,

                dataType: "json",

                success: function (data) {
                    window.location.reload();
                    alert(data.message);

                },
                error: function (data) {
                    alert(data.message);

                }
            });
            return false;
        });


    });
    $("#DeleteForm_Content").submit(function () {
        var delete_id = itemid;
        $.ajax({
            type: 'POST',
            data: {
                "delete_id": delete_id,
            },
            async: false,
            url: "{% url "timeliner_delete" %}",
            cache: false,
            dataType: "json",
            success: function (data) {
                window.location.reload();
                alert(data.message);

            },
            error: function (data) {
                alert(data.message);

            }
        });
        return false;
    });


</script>

<script>
    layui.use('element', function () {
        var $ = layui.jquery
            , element = layui.element; //Tab的切换功能，切换事件监听等，需要依赖element模块

        //触发事件
        var active = {
            tabAdd: function () {
                //新增一个Tab项
                element.tabAdd('demo', {
                    title: '新选项' + (Math.random() * 1000 | 0) //用于演示
                    , content: '内容' + (Math.random() * 1000 | 0)
                    , id: new Date().getTime() //实际使用一般是规定好的id，这里以时间戳模拟下
                })
            }
            , tabDelete: function (othis) {
                //删除指定Tab项
                element.tabDelete('demo', '44'); //删除：“商品管理”


                othis.addClass('layui-btn-disabled');
            }
            , tabChange: function () {
                //切换到指定Tab项
                element.tabChange('demo', '22'); //切换到：用户管理
            }
        };

        $('.site-demo-active').on('click', function () {
            var othis = $(this), type = othis.data('type');
            active[type] ? active[type].call(this, othis) : '';
        });

        //Hash地址的定位
        var layid = location.hash.replace(/^#test=/, '');
        element.tabChange('test', layid);

        element.on('tab(test)', function (elem) {
            location.hash = 'test=' + $(this).attr('lay-id');
        });

    });


</script>
<script>
    layui.use(['carousel', 'form'], function () {
        var carousel = layui.carousel
            , form = layui.form;

        //常规轮播
        carousel.render({
            elem: '#test1'
            , width: '1250px'
            , height: '600px'
            , arrow: 'always'
        });

        //改变下时间间隔、动画类型、高度
        carousel.render({
            elem: '#test2'
            , interval: 1800
            , anim: 'fade'
            , height: '120px'
        });

        //设定各种参数
        var ins3 = carousel.render({
            elem: '#test3'
        });
        //图片轮播
        carousel.render({
            elem: '#test10'
            , width: '778px'
            , height: '440px'
            , interval: 5000
        });

        //事件
        carousel.on('change(test4)', function (res) {
            console.log(res)
        });

        var $ = layui.$, active = {
            set: function (othis) {
                var THIS = 'layui-bg-normal'
                    , key = othis.data('key')
                    , options = {};

                othis.css('background-color', '#5FB878').siblings().removeAttr('style');
                options[key] = othis.data('value');
                ins3.reload(options);
            }
        };

        //监听开关
        form.on('switch(autoplay)', function () {
            ins3.reload({
                autoplay: this.checked
            });
        });

        $('.demoSet').on('keyup', function () {
            var value = this.value
                , options = {};
            if (!/^\d+$/.test(value)) return;

            options[this.name] = value;
            ins3.reload(options);
        });

        //其它示例
        $('.demoTest .layui-btn').on('click', function () {
            var othis = $(this), type = othis.data('type');
            active[type] ? active[type].call(this, othis) : '';
        });
    });


</script>
<script>
    layui.use('layer', function () { //独立版的layer无需执行这一句
        var $ = layui.jquery, layer = layui.layer; //独立版的layer无需执行这一句

        //触发事件
        var active = {
            setTop: function () {
                var that = this;
                //多窗口模式，层叠置顶
                layer.open({
                    type: 2 //此处以iframe举例
                    , title: '当你选择该窗体时，即会在最顶端'
                    , area: ['390px', '260px']
                    , shade: 0
                    , maxmin: true
                    , offset: [ //为了演示，随机坐标
                        Math.random() * ($(window).height() - 300)
                        , Math.random() * ($(window).width() - 390)
                    ]
                    , content: '//layer.layui.com/test/settop.html'
                    , btn: ['继续弹出', '全部关闭'] //只是为了演示
                    , yes: function () {
                        $(that).click();
                    }
                    , btn2: function () {
                        layer.closeAll();
                    }

                    , zIndex: layer.zIndex //重点1
                    , success: function (layero) {
                        layer.setTop(layero); //重点2
                    }
                });
            }
            , confirmTrans: function () {
                //配置一个透明的询问框
                layer.msg('大部分参数都是可以公用的<br>合理搭配，展示不一样的风格', {
                    time: 20000, //20s后自动关闭
                    btn: ['明白了', '知道了', '哦']
                });
            }
            , notice: function () {
                //示范一个公告层
                layer.open({
                    type: 1
                    ,
                    title: false //不显示标题栏
                    ,
                    closeBtn: false
                    ,
                    area: '300px;'
                    ,
                    shade: 0.8
                    ,
                    id: 'LAY_layuipro' //设定一个id，防止重复弹出
                    ,
                    btn: ['火速围观', '残忍拒绝']
                    ,
                    btnAlign: 'c'
                    ,
                    moveType: 1 //拖拽模式，0或者1
                    ,
                    content: '<div style="padding: 50px; line-height: 22px; background-color: #393D49; color: #fff; font-weight: 300;">你知道吗？亲！<br>layer ≠ layui<br><br>layer只是作为Layui的一个弹层模块，由于其用户基数较大，所以常常会有人以为layui是layerui<br><br>layer虽然已被 Layui 收编为内置的弹层模块，但仍然会作为一个独立组件全力维护、升级。<br><br>我们此后的征途是星辰大海 ^_^</div>'
                    ,
                    success: function (layero) {
                        var btn = layero.find('.layui-layer-btn');
                        btn.find('.layui-layer-btn0').attr({
                            href: 'http://www.layui.com/'
                            , target: '_blank'
                        });
                    }
                });
            }
            , offset: function (othis) {
                var type = othis.data('type')
                    , text = othis.text();

                layer.open({
                    type: 1
                    , offset: type //具体配置参考：http://www.layui.com/doc/modules/layer.html#offset
                    , id: 'layerDemo' + type //防止重复弹出
                    , content: '<div style="padding: 20px 100px;">' + text + '</div>'
                    , btn: '关闭全部'
                    , btnAlign: 'c' //按钮居中
                    , shade: 0 //不显示遮罩
                    , yes: function () {
                        layer.closeAll();
                    }
                });
            }
        };

        $('#layerDemo .layui-btn').on('click', function () {
            var othis = $(this), method = othis.data('method');
            active[method] ? active[method].call(this, othis) : '';
        });

    });
</script>
<!-- END PAGE LEVEL JS-->
</body>
</html>