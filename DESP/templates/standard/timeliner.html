<!DOCTYPE html>
{% load static %}

<html lang="en" class="loading">
<head>
    <style>
        .black_overlay {
            display: none;
            position: absolute;
            top: 0%;
            left: 0%;
            width: 100%;
            height: 100%;
            background-color: black;
            z-index: 1001;
            -moz-opacity: 0.8;
            opacity: .80;
            filter: alpha(opacity=88);
        }

        .white_content {
            display: none;
            position: absolute;
            top: 25%;
            left: 40%;
            width: 25%;
            height: auto;
            padding: 20px;
            border: 10px solid orange;
            background-color: white;
            z-index: 1002;
            overflow: auto;
        }
    </style>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta name="description"
          content="Convex admin is super flexible, powerful, clean &amp; modern responsive bootstrap 4 admin template with unlimited possibilities.">
    <meta name="keywords"
          content="admin template, Convex admin template, dashboard template, flat admin template, responsive admin template, web app">
    <meta name="author" content="PIXINVENT">
    <title>Page for timeline</title>
    <link rel="apple-touch-icon" sizes="60x60" href="{% static 'app-assets/img/ico/apple-icon-60.png' %}">
    <link rel="apple-touch-icon" sizes="76x76" href="{% static 'app-assets/img/ico/apple-icon-76.png' %}">
    <link rel="apple-touch-icon" sizes="120x120" href="{% static 'app-assets/img/ico/apple-icon-120.png' %}">
    <link rel="apple-touch-icon" sizes="152x152" href="{% static 'app-assets/img/ico/apple-icon-152.png' %}">
    <link rel="shortcut icon" type="image/x-icon" href="{% static 'app-assets/img/ico/favicon.ico' %}">
    <link rel="shortcut icon" type="image/png" href="{% static 'app-assets/img/ico/favicon-32.png' %}">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/fonts/feather/style.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/fonts/simple-line-icons/style.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/fonts/font-awesome/css/font-awesome.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/perfect-scrollbar.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/prism.min.css' %}">
    <link rel="stylesheet" type="text/css"
          href="{% static 'app-assets/vendors/css/tables/datatable/datatables.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/app.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'layui/css/layui.css' %}" media="all">
    <link rel="stylesheet" type="text/css" href="{% static 'layui/css/modules/laydate/default/laydate.css' %}"
          media="all">
    {#    <link rel="stylesheet" type="text/css" href="{% static 'layui_exts/laydateNote/laydateNote.css' %}" media="all">#}
    {#    <link rel="stylesheet" type="text/css" href="{% static 'test2/lib/jquery-ui-1.8.4.js' %}" media="all">#}
    {#    <link rel="stylesheet" type="text/css" href="{% static 'test2/example/reset.css' %}" media="all">#}
    {#    <link rel="stylesheet" type="text/css" href="{% static 'test2/jquery.ganttView.css' %}" media="all">#}
    <link rel="stylesheet" href="{% static 'layui/css/layui.css' %}">

</head>
<body data-col="2-columns" class=" 2-columns ">

<!--modals begin-->
<!--add-->
<div id="mymodal" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabel">添加工作项目</h4>
                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body">
                <form id="CreateForm_Content" method="post">{% csrf_token %}
                    <div>
                        <label>工作项目</label>
                        <div>
                            <input type="text" id="create_name"
                                   name="name" required>
                        </div>
                    </div>

                    <div>
                        <label>工作内容</label>

                        <textarea style="height:80px; width:420px" id="create_content"
                                  name="content" required></textarea>

                    </div>

                    <div>
                        <label>评估项目</label>
                        <div>
                            <input type="text" id="create_eval"
                                   name="time_eval" list="time_eval_list" required>
                            <datalist id="time_eval_list">
                                {% for evals in evalname %}
                                    <option>{{ evals.table_evaluation_col_name }}</option>
                                {% endfor %}
                            </datalist>
                        </div>
                    </div>

                    <div>
                        <label>开始时间</label>
                        <div>
                            <input type="date" id="create_start"
                                   name="field" required>
                        </div>
                    </div>
                    <div>
                        <label>结束时间</label>
                        <div>
                            <input type="date" id="create_end"
                                   name="field" required>
                        </div>
                    </div>
                    <div>
                        <label>工作状态</label>
                        <div>
                            <input type="text" id="create_status"
                                   name="time_status" list="time_status_list" required>
                            <datalist id="time_status_list">
                                <option>未开始</option>
                                <option>进行中</option>
                                <option>已完成</option>
                            </datalist>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default"
                                data-dismiss="modal">关闭
                        </button>
                        <button type="submit" class="btn btn-primary"
                                id="add">提交更改
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- Edit Index -->
<div id="mymodal_edit" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="EditLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="EditLabel">修改工作项目</h4>
                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body">
                <form id="EditForm_Content" method="post">{% csrf_token %}
                    <div>
                        <label>工作项目</label>
                        <div>
                            <input type="text" id="edit_name"
                                   name="name" required>
                        </div>
                    </div>

                    <div>
                        <label>工作内容</label>

                        <textarea style="height:80px; width:420px" id="edit_content"
                                  name="content" required></textarea>

                    </div>

                    <div>
                        <label>开始时间</label>
                        <div>
                            <input type="date" id="edit_start"
                                   name="field" required>
                        </div>
                    </div>
                    <div>
                        <label>结束时间</label>
                        <div>
                            <input type="date" id="edit_end"
                                   name="field" required>
                        </div>
                    </div>

                    <div>
                        <label>工作状态</label>
                        <div>
                            <input type="text" id="edit_status"
                                   name="time_status" list="time_status_list" required>
                            <datalist id="time_status_list">
                                <option>未开始</option>
                                <option>进行中</option>
                                <option>已完成</option>
                            </datalist>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-default"
                                data-dismiss="modal">关闭
                        </button>
                        <button type="submit" class="btn btn-primary"
                                id="add">提交更改
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!--Delete Form-->
<div id="mymodal_delete" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="DeleteLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="DeleteLabel">删除</h4>
                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body">
                <form id="DeleteForm_Content" method="post">{% csrf_token %}
                    <div>
                        <span>您确定要删除吗？</span>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default"
                                data-dismiss="modal">关闭
                        </button>
                        <button type="submit" class="btn btn-primary"
                                id="delete_add">确定
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div id="password_edit" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="password_edit" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="password_edit">修改信息</h4>
                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body">
                <form id="password_edit" method="post">{% csrf_token %}

                    <div>
                        <label>输入新密码</label>
                        <div>
                            <input type="password" id="password_reset"
                                   name="password" required>
                        </div>
                    </div>
                    <div>
                        <label>再输入一次</label>
                        <div>
                            <input type="password" id="password_reset_twice"
                                   name="password_twice" required>
                        </div>
                    </div>


                    <div class="modal-footer">
                        <button type="button" class="btn btn-default"
                                data-dismiss="modal">关闭
                        </button>
                        <button type="submit" class="btn btn-primary"
                                id="add">提交更改
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- ////////////////////////////////////////////////////////////////////////////-->
<!--modals end-->
<div class="wrapper nav-collapsed menu-collapsed">

    <div data-active-color="white" data-background-color="primary" data-image="" class="app-sidebar">
        <div class="sidebar-header">
            <div class="logo clearfix"><a href="{% url 'administrator' %}" class="logo-text float-left">
                <div class="logo-img"><img src="{% static 'app-assets/img/logo.png' %}" alt="Convex Logo"/></div>
                <span class="text align-middle">CNIC</span></a><a id="sidebarToggle" href="javascript:;"
                                                                  class="nav-toggle d-none d-sm-none d-md-none d-lg-block"><i
                    data-toggle="collapsed" class="ft-circle toggle-icon"></i></a><a id="sidebarClose"
                                                                                     href="javascript:;"
                                                                                     class="nav-close d-block d-md-block d-lg-none d-xl-none"><i
                    class="ft-circle"></i></a></div>
        </div>
        <div class="sidebar-content">
            <div class="nav-container">
                <ul id="main-menu-navigation" data-menu="menu-navigation" class="navigation navigation-main">
                    <li class="has-sub nav-item"><a
                            href="{% url 'standard' %}?evalname={{ current_eval }}&admin={{ admin }}&id=0"><i
                            class="ft-menu"></i><span
                            data-i18n=""
                            class="menu-title">项目管理</span></a>
                    </li>

                    <li class="has-sub nav-item"><a
                            href="{% url 'timeliner' %}?timeevalname={{ current_eval }}&admin={{ admin }}"><i
                            class="icon-calendar"></i><span
                            data-i18n=""
                            class="menu-title">项目进度</span></a>
                    </li>

                    <li class="has-sub nav-item"><a
                            href="{% url 'questionaire_manage' %}?timeevalname={{ current_eval }}&admin={{ admin }}"><i
                            class="ft-file-text"></i><span
                            data-i18n=""
                            class="menu-title">数据采集</span></a>
                    </li>

                    <li class="has-sub nav-item"><a
                            href="{% url 'calculate' %}?timeevalname={{ current_eval }}&admin={{ admin }}"><i
                            class="ft-folder"></i><span
                            data-i18n=""
                            class="menu-title">数据统计</span></a>
                    </li>

                    <li class="has-sub nav-item"><a
                            href="{% url 'review' %}?timeevalname={{ current_eval }}&admin={{ admin }}"><i
                            class="ft-folder"></i><span
                            data-i18n=""
                            class="menu-title">问卷审核</span></a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="sidebar-background"></div>
    </div>

    <nav class="navbar navbar-expand-lg navbar-light bg-faded">
        <div class="container-fluid">
            <div class="navbar-header">

                <button type="button" data-toggle="collapse" class="navbar-toggle d-lg-none float-left"><span
                        class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span
                        class="icon-bar"></span><span class="icon-bar"></span></button>
                <span class="d-lg-none navbar-right navbar-collapse-toggle"><a class="open-navbar-container"><i
                        class="ft-more-vertical"></i></a></span><a id="navbar-fullscreen" href="javascript:;"
                                                                   class="mr-2 display-inline-block apptogglefullscreen"><i
                    class="ft-maximize blue-grey darken-4 toggleClass"></i>
                <p class="d-none">fullscreen</p></a>

            </div>
            <div class="navbar-container">
                <div id="navbarSupportedContent" class="collapse navbar-collapse">
                    <p>欢迎你，管理员&nbsp&nbsp&nbsp{{ admin }}</p>

                    <ul class="layui-nav-item">
                        <li class="dropdown layui-nav-item mr-0"><a id="dropdownBasic3" href="#" data-toggle="dropdown"
                                                                    class="nav-link position-relative dropdown-user-link dropdown-toggle"><span
                                class="avatar avatar-online"><img id="navbar-avatar"
                                                                  src="{% static 'app-assets/img/portrait/small/avatar-s-3.jpg' %}"
                                                                  alt="avatar"/></span>
                            <p class="d-none">User Settings</p></a>
                            <div aria-labelledby="dropdownBasic3" class="dropdown-menu dropdown-menu-right">
                                <div class="arrow_box_right">
                                    <a href="{% url 'logout' %}" class="dropdown-item"><i
                                            class="layui-icon layui-icon-logout"
                                            style="font-size: 18px; color:black;"></i> <span>退出</span></a>
                                </div>
                                <div class="arrow_box_right">

                                    <a href="" class="dropdown-item " data-toggle="modal"
                                                data-target="#password_edit"><i class="layui-icon layui-icon-user"
                                                                        style="font-size: 18px; color:black;"></i>
                                        <span>修改密码</span></a>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>
    <!--End of sidebar and navibar-->
    <div class="main-panel">
        <div class="main-content">
            <div class="content-wrapper">
                <div class="container-fluid"><!-- Base style table -->
                    <section id="base-style">
                        <div class="row">
                            <div class="col-12">
                                <div class="layui-tab layui-tab-card">
                                    <ul class="layui-tab-title">
                                        <li class="layui-this">甘特图</li>
                                        <li>项目列表</li>
                                    </ul>
                                    <div class="layui-tab-content">
                                        <div class="layui-tab-item layui-show">
                                            <!-- Begin Blue Gantt -->
                                            <div class="card">
                                                <div class="card-header">
                                                    <button type="button" class="btn mr-1 btn-secondary"
                                                            data-toggle="modal"
                                                            data-target="#mymodal">添加新项目
                                                    </button>
                                                </div>
                                                <div id="blue_gantt" style="height: 430px;"></div>
                                            </div>
                                        </div>
                                        <div class="layui-tab-item">
                                            <!-- Begin Table -->
                                            <div class="card">
                                                <div class="card-header">
                                                    <button type="button" class="btn mr-1 btn-secondary"
                                                            data-toggle="modal"
                                                            data-target="#mymodal">添加新项目
                                                    </button>
                                                </div>
                                                <div class="card-body collapse show">
                                                    <div class="card-block card-dashboard">
                                                        <p class="card-text"></p>
                                                        <table class="table table-striped table-bordered base-style">
                                                            <thead>
                                                            <tr>
                                                                <th>开始时间</th>
                                                                <th>工作项目</th>
                                                                <th>工作内容</th>
                                                                <th>截止时间</th>
                                                                <th>工作状态</th>
                                                                <th>操作</th>
                                                            </tr>
                                                            </thead>
                                                            <tbody>
                                                            {% for t in test_list %}
                                                                <tr>
                                                                    <td>{{ t.table_timeliner_col_start }}</td>
                                                                    <td>{{ t.table_timeliner_col_name }}</td>
                                                                    <td>{{ t.table_timeliner_col_content }}</td>
                                                                    <td>{{ t.table_timeliner_col_end }}</td>
                                                                    <td>{{ t.table_timeliner_col_status }}</td>
                                                                    <td>
                                                                        <button type="button"
                                                                                class="btn mr-1 btn-secondary"
                                                                                data-toggle="modal"
                                                                                data-target="#mymodal_edit"
                                                                                id="{{ t.table_timeliner_col_id }}"
                                                                                onclick="timeliner_edit(this.id)">
                                                                            <i class="layui-icon">编辑</i>
                                                                        </button>
                                                                        <button type="button"
                                                                                class="btn mr-1 btn-secondary"
                                                                                data-toggle="modal"
                                                                                data-target="#mymodal_delete"
                                                                                id="{{ t.table_timeliner_col_id }}"
                                                                                onclick="go(this.id)">
                                                                            <i class="layui-icon">删除</i>
                                                                        </button>
                                                                        {#  上传文件  #}
                                                                        <button type="button"
                                                                                class="btn mr-1 btn-secondary"
                                                                                {# <i class="layui-icon"><a #}
                                                                                href="javascript:void(0)"
                                                                                onclick="document.getElementById('light01+{{ t.table_timeliner_col_name }}').style.display='block';
                                                                                        document.getElementById('fade').style.display='block'">
                                                                            上传文件
                                                                            {#</a></i>#}
                                                                        </button>
                                                                        <div id="light01+{{ t.table_timeliner_col_name }}"
                                                                             class="white_content">
                                                                            <form enctype="multipart/form-data" method="post" action="/uploadFile/">
                                                                                {# action="/uploadFile/"#}
                                                                                工作项目: {{ t.table_timeliner_col_name }}<br><br>
                                                                                {% csrf_token %}
                                                                                <input type="file" name="myfile" id="{{ t.table_timeliner_col_name }}"/><br><br>
                                                                                <input style="display: none" type="text" name="pro_name_1" value="{{ current_eval }}">
                                                                                <input style="display: none" type="text" name="pro_name_2" value="{{ t.table_timeliner_col_name }}"><br>
                                                                                <button class="btn mr-1 btn-secondary"
                                                                                        type="submit" value="upload"
                                                                                        onclick="AjaxSubmitFile()">提交
                                                                                </button>
                                                                                &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
                                                                                <a href="javascript:void(0)"
                                                                                    onclick="document.getElementById('light01+{{ t.table_timeliner_col_name }}').style.display='none';
                                                                                       document.getElementById('fade').style.display='none'">关闭
                                                                                </a>
                                                                            </form>
                                                                        </div>
                                                                        {#  下载文件  #}
                                                                        <button type="submit"
                                                                                class="btn mr-1 btn-secondary"
                                                                                href="javascript:void(0)"
                                                                                onclick="document.getElementById('light02+{{ t.table_timeliner_col_name }}').style.display='block';">下载文件
                                                                        </button>
                                                                        <div id="light02+{{ t.table_timeliner_col_name }}"
                                                                             class="white_content">
                                                                            <form enctype="multipart/form-data" action="{% url 'download_file' %}"
                                                                                  method="post" name="download_files">
                                                                                工作项目: {{ t.table_timeliner_col_name }}
                                                                                <br><br>
                                                                                {% csrf_token %}
                                                                                <input style="display: none" type="text" name="pro_name_d_1" value="{{ current_eval }}">
                                                                                <input style="display: none" type="text" name="pro_name_d_2" value="{{ t.table_timeliner_col_name }}">
                                                                                <input style="display: none" type="text" name="length_{{ t.table_timeliner_col_name }}" value="{{ t.table_upload_file | length }}">
                                                                                <input style="display: none" type="text" name="checkall_{{ t.table_timeliner_col_name }}" value="no_select">
                                                                                <input type="checkbox"
                                                                                       id="check_{{ t.table_timeliner_col_name }}"
                                                                                       name="check_box_{{ t.table_timeliner_col_name }}"
                                                                                       onclick="checkall('{{ t.table_timeliner_col_name }}')">
                                                                                <strong>全选</strong><br>
                                                                                {% for u in t.table_upload_file %}
                                                                                    <input style="display: none" type="text" name="checkson{{ forloop.counter0 }}" value="{{ u.file_name }}">
                                                                                    <input style="display: none" type="text" name="checksoncheck{{ t.table_timeliner_col_name }}{{ forloop.counter0 }}" value="no_select">
                                                                                    <input type="checkbox"
                                                                                           id="checkson_{{ t.table_timeliner_col_name }}{{ forloop.counter0 }}"
                                                                                           name="checkson_box_{{ t.table_timeliner_col_name }}"
                                                                                           value="{{ u.file_name }}"
                                                                                           onclick="checkone('{{ t.table_timeliner_col_name }}','{{ forloop.counter0 }}')">
                                                                                    {{ u.file_name }}<br>
                                                                                {% endfor %}<br><br>
                                                                                <button class="btn mr-1 btn-secondary"
                                                                                        type="submit">下载
                                                                                </button>
                                                                                &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
                                                                                <a href="javascript:void(0)"
                                                                                   onclick="document.getElementById('light02+{{ t.table_timeliner_col_name }}').style.display='none';">关闭
                                                                                </a>
                                                                            </form>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            {% endfor %}
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <!--/ Base style table -->
                </div>
            </div>
        </div>

        <footer class="footer footer-static footer-light">
            <p class="clearfix text-muted text-center px-2"><span>Copyright  &copy; CNIC <a href="#" id="pixinventLink"
                                                                                            target="_blank"
                                                                                            class="text-bold-800 primary darken-2"></a>, All rights reserved. </span>
            </p>
        </footer>
    </div>
</div>


<!-- ////////////////////////////////////////////////////////////////////////////-->
<!-- BEGIN VENDOR JS-->
<script src="{% static 'app-assets/vendors/js/core/jquery-3.3.1.min.js' %}"></script>
<script src="{% static 'app-assets/vendors/js/core/popper.min.js' %}"></script>
<script src="{% static 'app-assets/vendors/js/core/bootstrap.min.js' %}"></script>
<script src="{% static 'app-assets/vendors/js/perfect-scrollbar.jquery.min.js' %}"></script>
<script src="{% static 'app-assets/vendors/js/prism.min.js' %}"></script>
<script src="{% static 'app-assets/vendors/js/jquery.matchHeight-min.js' %}"></script>
<script src="{% static 'app-assets/vendors/js/screenfull.min.js' %}"></script>
<script src="{% static 'app-assets/vendors/js/pace/pace.min.js' %}"></script>
<!-- END VENDOR JS-->
<!-- BEGIN PAGE VENDOR JS-->
<script src="{% static 'app-assets/vendors/js/datatable/datatables.min.js' %}"></script>
<!-- END PAGE VENDOR JS-->
<!-- BEGIN CONVEX JS-->
<script src="{% static 'app-assets/js/app-sidebar.js' %}"></script>
<script src="{% static 'app-assets/js/notification-sidebar.js' %}"></script>
<!-- END CONVEX JS-->
<!-- BEGIN BUTTON JS -->
<script>
    function AjaxSubmitFile() {
        var myfile = document.getElementsByName("myfile").files[0];
        $.ajax({})

    }
</script>
<script>
    function checkone(value1, value2){
        text1 = "checkson_" + value1 + value2
        text2 = "checksoncheck" + value1 + value2
        console.log(text1)

        var checked = document.getElementById(text1).checked;
        var check_one = document.getElementsByName(text2);
        if (checked) {
            for (var n = 0; n < check_one.length; n++) {
                    check_one[n].value = "select";
                }
        }else {
            for (var n = 0; n < check_one.length; n++) {
                check_one[n].value = "no_select";
            }
        }
    }

    function checkall(value){
        text1 = "check_" + value
        text2 = "checkson_box_" + value
        text3 = "checkall_" + value
        {#document.getElementById("check").onclick = function () {#}
        var checked = document.getElementById(text1).checked;
        var checkson = document.getElementsByName(text2);
        var checkall = document.getElementsByName(text3);
        if (checked){
            for (var i = 0; i < checkson.length; i++) {
                checkson[i].checked = true;
                for (var n = 0; n < checkall.length; n++) {
                    checkall[n].value = "select";
                }
            }
        } else {
            for (var i = 0; i < checkson.length; i++) {
                checkson[i].checked = false;
                for (var n = 0; n < checkall.length; n++) {
                    checkall[n].value = "no_select";
                }
            }
        }
    }
</script>
<script>
    function go(id) {
        itemid = id
    }
</script>
<script>
    var files = {{ test_list|safe }};
    var count = len(files)
    console.log(files[0])
    for (var i = 0; i < count; i++) {
        $('#light02+' + files[i]['table_upload_file_col_'])
    }
    var pro_name = files[0]['indicator_id'];
    $('#question_list').append("<input style=\'display: none\' name='\indicatorID\'\n value=" + indicator_id + ">");
</script>
<script>
    $(document).ready(function () {
        $(function () {
            $("#upload_flag").dialog({
                modal: true,
                closeOnEscape: false,
                dialogClass: "no-close",
                resizable: false,
                draggable: false,
                width: 600,
                buttons: [
                    {
                        text: "OK",
                        click: function () {
                            $(this).dialog("close");
                        }
                    }
                ]
            });
        });
    });
</script>
<script>
    function timeliner_edit(id) {
        itemid = id;
        $.ajax({
            type: 'GET',
            data: {
                'edit_id': itemid
            },
            url: "{% url "timeliner_edit" %}",
            dataType: 'json',
            success: function (data) {
                $("#edit_name").attr("value", eval("(" + data.timeline + ")")[0].fields.table_timeliner_col_name);
                $("#edit_content").val(eval("(" + data.timeline + ")")[0].fields.table_timeliner_col_content);
                $('#edit_start').attr("value", eval("(" + data.timeline + ")")[0].fields.table_timeliner_col_start);
                $('#edit_end').attr("value", eval("(" + data.timeline + ")")[0].fields.table_timeliner_col_end);
                $('#edit_status').attr("value", eval("(" + data.timeline + ")")[0].fields.table_timeliner_col_status);
            }

        });
        $('#mymodal_edit').modal('show');
    }
</script>

<script type="text/javascript">
    $(document).ready(function () {
        $.ajaxSetup({
            data: {csrfmiddlewaretoken: "{{ csrf_token }}"},
        });

        $("#CreateForm_Content").submit(function () {
            var create_name = $("#create_name").val();
            var create_content = $("#create_content").val();
            var create_start = $('#create_start').val();
            var create_end = $('#create_end').val();
            var create_status = $('#create_status').val();
            var create_eval = $('#create_eval').val();
            $.ajax({
                type: 'POST',
                data: {
                    "name": create_name,
                    "content": create_content,
                    'start': create_start,
                    'end': create_end,
                    'status': create_status,
                    'eval': create_eval
                },
                url: "{% url "timeliner_create" %}",
                cache: false,

                dataType: "json",

                success: function (data) {
                    window.location.reload();
                    alert(data.message);
                },
                error: function (data) {
                    alert(data.message);
                }
            });
            return false;
        });

        $("#EditForm_Content").submit(function (event) {
            event.preventDefault();

            var edit_id = itemid;
            var edit_name = $("#edit_name").val();
            var edit_content = $("#edit_content").val();
            var edit_start = $('#edit_start').val();
            var edit_end = $('#edit_end').val();
            var edit_status = $('#edit_status').val();
            $.ajax({
                type: 'POST',
                data: {
                    'edit_id': edit_id,
                    'edit_name': edit_name,
                    "content": edit_content,
                    'start': edit_start,
                    'end': edit_end,
                    'status': edit_status
                },
                async: false,
                url: "{% url "timeliner_edit" %}",
                cache: false,

                dataType: "json",

                success: function (data) {
                    window.location.reload();
                    alert(data.message);

                },
                error: function (data) {
                    alert(data.message);

                }
            });
            return false;
        });


    });
    $("#DeleteForm_Content").submit(function () {
        var delete_id = itemid;
        $.ajax({
            type: 'POST',
            data: {
                "delete_id": delete_id,
            },
            async: false,
            url: "{% url "timeliner_delete" %}",
            cache: false,
            dataType: "json",
            success: function (data) {
                window.location.reload();
                alert(data.message);

            },
            error: function (data) {
                alert(data.message);

            }
        });
        return false;
    });

</script>
<!-- BEGIN ECHARTS GANTT BLUE JS -->
{#<script src="{% static 'js/echarts.js' %}"></script>#}
<script src="{% static 'js/echarts.min.js' %}"></script>
<script type="text/javascript">
    i = 0;

    var myChart = echarts.init(document.getElementById('blue_gantt'));
    var cate = [];
    {% for t in timeline_list %}
        cate.push('{{ t.table_timeliner_col_name }}');
    {% endfor %}
    var categories = cate;
    var dayTime = 3600 * 24 * 1000;
    var nowDate = new Date();//今日日期获取系统时间
    var nowDateStr = formatDate(nowDate);
    console.log(nowDateStr);

    function formatDate(date) {
        //将2020/2/3这种日期格式，转换为2020-02-03
        var arr = date.toLocaleDateString().split("/");
        if (arr[1].length < 2) {//对月份进行处理：如果月份的长度为1，则拼接上字符串0
            arr.splice(1, 1, "0" + arr[1]);
        }
        if (arr[2].length < 2) {//对天数进行处理：如果天数的长度为2，则拼接上字符串0
            arr.splice(2, 1, "0" + arr[2]);
        }
        return arr.join("-");
    }

    var data = [
        {% for t in timeline_list %}
            {
                name: "{{ t.table_timeliner_col_name }}",
                //项目索引  计划开始日期   计划结束日期， 实际开始日期  项目内容
                value: [i, '{{ t.table_timeliner_col_start }}', '{{ t.table_timeliner_col_end}}', '', '{{ t.table_timeliner_col_content }}'],
            },
            i++,
        {% endfor %}
    ];

    //在渲染时，data中的每个数据项都会调用这个方法
    function renderItem(params, api) {//params为data中的数据项的信息对象    api中是一些开发者可调用的方法集合，可以对data中的数据项进行操作
        var nowDatePX = api.coord([nowDateStr, categoryIndex]);
        var categoryIndex = api.value(0);//取出data中数据项的第一个维度的值
        //===============计划工期进度条
        //计划开始日期(在屏幕上的像素值)
        var planStartDate = api.coord([api.value(1), categoryIndex]);//将数据项中的数值对应的坐标系上的点，转换为屏幕上的像素值
        //坐标系上的点：是数据项映射到坐标系的x轴和y轴后，对应的位置
        //屏幕上的像素值：是坐标系上的点，在屏幕上的位置
        //计划结束日期(在屏幕上的像素值)
        var planEndDate = api.coord([api.value(2), categoryIndex]);
        //由于data.value中维度1和维度2的数据会被映射到x轴，而x轴的type为time，即时间轴，
        //所以api.value(1)和api.value(2)获取到的值是将日期转换后的毫秒

        //设置图形的高度
        var height = api.size([0, 1])[1] * 0.4;//获得Y轴上数值范围为1的一段所对应的像素长度；这是官方文档的注释，对于api.size()方法，目前我还不是很理解；先做个标记??? 以后再说

        //使用graphic图形元素组件，绘制矩形
        //clipRectByRect方法，在绘制矩形时，如果矩形大小超出了当前坐标系的包围盒，则裁剪这个矩形
        var rectShape1 = echarts.graphic.clipRectByRect({
            //矩形的位置
            x: planStartDate[0],
            y: planStartDate[1],
            //矩形的宽高
            width: planEndDate[0] - planStartDate[0],
            height: height
        }, {
            //当前坐标系的包围盒
            x: params.coordSys.x,
            y: params.coordSys.y,
            width: params.coordSys.width,
            height: params.coordSys.height
        });


        //===============实际工期进度条
        var rectShape2 = null;

        //判断实际开始日期是否为空，如果为空，说明项目还没开始
        if (api.value(3) !== '') {//如果实际开始日期不为空
            //实际开始日期(在屏幕上的像素值)
            var practiceStartDate = api.coord([api.value(3), categoryIndex]);
            //当前日期或实际结束日期
            var nowDate_or_practiceEndDate;
            //项目周期(毫秒值)：计划结束日期(毫秒值) - 计划开始日期(毫秒值)
            var projectCycle_millisecond = api.value(2) - api.value(1);
            //实际开始日期(毫秒值)
            var practiceStartDate_millisecond = +echarts.number.parseDate(api.value(3));
            //当前日期(毫秒值)
            var nowDate_millisecond = +echarts.number.parseDate(nowDateStr);
            //如果项目进度未完成或刚好完成。
            //比如计划开始时间1月10日，计划结束时间1月20日，项目周期10天，实际开始时间1月10日，当前日期1月18日，说明项目进度未完成
            //那么在渲染实际工期的进度条时，进度条的范围为1月10日至1月18日(实际开始日期至当前日期)
            //比如计划开始时间1月10日，计划结束时间1月20日，项目周期10天，实际开始时间1月10日，当前日期1月20日，说明项目进度刚好完成
            //那么在渲染实际工期的进度条时，进度条的范围为1月10日至1月20日(实际开始日期至当前日期)
            if ((nowDate_millisecond - practiceStartDate_millisecond) <= projectCycle_millisecond) {
                //取当前日期(在屏幕上的像素值)
                nowDate_or_practiceEndDate = api.coord([nowDate_millisecond, categoryIndex]);
            } else {//比如计划开始时间1月10日，计划结束时间1月20日，项目周期10天，实际开始时间1月10日，当前日期1月22日，说明项目已结束
                //那么在渲染实际工期的进度条时，进度条的范围应该是1月10日至1月20日(实际开始日期至实际结束日期)，
                //而不是1月10日至1月22日(实际开始日期至当前日期)
                //实际结束日期(毫秒值)：实际开始日期(毫秒值) + 项目周期(毫秒值)
                var practiceEndDate_millisecond = practiceStartDate_millisecond + projectCycle_millisecond;
                //取实际结束日期(在屏幕上的像素值)
                nowDate_or_practiceEndDate = api.coord([practiceEndDate_millisecond, categoryIndex]);
            }

            //使用graphic图形元素组件，绘制矩形
            //clipRectByRect方法，在绘制矩形时，如果矩形大小超出了当前坐标系的包围盒，则裁剪这个矩形
            rectShape2 = echarts.graphic.clipRectByRect({
                //矩形的位置
                x: practiceStartDate[0],
                y: practiceStartDate[1],
                //矩形的宽高
                width: nowDate_or_practiceEndDate[0] - practiceStartDate[0],
                height: height
            }, {
                //当前坐标系的包围盒
                x: params.coordSys.x,
                y: params.coordSys.y,
                width: params.coordSys.width,
                height: params.coordSys.height
            });
        }


        //case1：如果项目还没开始，那么只渲染计划工期的进度条
        if (rectShape2 == null) {
            //设置绘制的矩形的元素定义
            //TODO 施加一个与系统时间对比的操作，将项目节点分类
            //case1.1: 已完成
            if (planEndDate[0] <= nowDatePX[0]) {
                return rectShape1 && {
                    type: 'group',
                    children: [
                        {
                            //类型为矩形
                            type: 'rect',
                            //具体形状
                            shape: rectShape1,
                            //样式
                            style: api.style({
                                fill: '#5574ff'
                            })
                        }
                    ]
                };
                //case1.2: 进行中
            } else if ((planStartDate[0] <= nowDatePX[0]) && (planEndDate[0] >= nowDatePX[0])) {
                //} else if (rectShape1.x - rectShape1.width < 400) {
                return rectShape1 && {
                    type: 'group',
                    children: [
                        {
                            //类型为矩形
                            type: 'rect',
                            //具体形状
                            shape: rectShape1,
                            //样式
                            style: api.style({
                                fill: '#ff3a45'
                            })
                        }
                    ]
                };
                //case1.3: 未开始
                //} else {
            } else if (planStartDate[0] > nowDatePX[0]) {
                return rectShape1 && {
                    type: 'group',
                    children: [
                        {
                            //类型为矩形
                            type: 'rect',
                            //具体形状
                            shape: rectShape1,
                            //样式
                            style: api.style({
                                fill: '#fff62e'
                            })
                        }
                    ]
                };
            }
        }
        //case2：渲染计划工期和实际工期
        else {
            //设置绘制的矩形的元素定义
            return rectShape1 && rectShape2 && {
                type: 'group',
                children: [
                    {
                        //类型为矩形
                        type: 'rect',
                        //具体形状
                        shape: rectShape1,
                        //样式
                        style: api.style({
                            fill: '#5574ff'
                        })
                    },
                    {
                        //类型为矩形
                        type: 'rect',
                        //具体形状
                        shape: rectShape2,
                        //样式
                        style: api.style({
                            fill: '#55abc0'
                        })
                    }
                ]
            };
        }
    }

    myChart.setOption({
        tooltip: {
            //自定义提示信息
            formatter: function (params) {//params为当前点击图形元素的数据信息的对象
                //计划开始时间
                var planStartDate = params.value[1];
                //计划结束时间
                var planEndDate = params.value[2];
                //实际开始时间
                var practiceStartDate = "";
                var practiceStartDate_str = "";
                if (params.value[3]) {
                    practiceStartDate = params.value[3];
                    practiceStartDate_str = '实际开始日期：' + practiceStartDate + '<br/>';

                }

                //项目周期(毫秒值)：计划结束日期 - 计划开始日期
                var projectCycle_millisecond = +echarts.number.parseDate(params.value[2]) - +echarts.number.parseDate(params.value[1]);
                //项目周期(天数)
                var projectCycle_days = projectCycle_millisecond / dayTime;
                //当前进度(百分比)
                var currentProgress_percentage;
                var currentProgress_percentage_str = "";
                if (practiceStartDate !== '') {//如果实际开始日期不为空，说明项目已开始
                    //当前进度(毫秒值)：当前日期(毫秒值) - 实际开始日期(毫秒值)
                    var currentProgress_mill = +echarts.number.parseDate(nowDateStr) - +echarts.number.parseDate(params.value[3]);
                    //当前进度(百分比)：当前进度(毫秒值) / 项目周期(毫秒值)
                    currentProgress_percentage = ((currentProgress_mill / projectCycle_millisecond) * 100).toFixed(0);//注意，toFixed的返回值是字符串类型
                    //如果项目已结束：比如计划开始时间1月10日，计划结束时间1月20日，项目周期10天，实际开始时间1月10日，当前日期1月22日，说明项目已结束
                    //那么按照(当前日期-实际开始日期)/项目周期，计算出的百分比，就会大于100，所以需要将百分比置为100
                    if (currentProgress_percentage > 100) {//项目已结束
                        currentProgress_percentage = 100;
                    }
                    currentProgress_percentage_str = '当前进度：' + currentProgress_percentage + '%' + '<br/>';
                }

                //实际结束时间
                var practiceEndDate = "";
                var practiceEndDate_str = "";
                if (currentProgress_percentage === 100) {//如果项目进度已完成或项目已结束
                    //实际结束时间(毫秒值)：实际开始日期(毫秒值) + 项目周期(毫秒值)
                    var practiceEndDate_millisecond = +echarts.number.parseDate(practiceStartDate) + projectCycle_millisecond;
                    //实际结束时间(日期格式)
                    practiceEndDate = echarts.format.formatTime('yyyy-MM-dd', practiceEndDate_millisecond);
                    practiceEndDate_str = '实际结束日期：' + practiceEndDate + '<br/>';
                }
                var projectContent = params.value[4];
                return params.name + '<br/>'
                    + '计划开始时间：' + planStartDate + '<br/>'
                    + '计划结束时间：' + planEndDate + '<br/>'
                    + '项目周期：' + projectCycle_days + '天<br/>'
                    + '项目内容：' + projectContent + '<br/>'
                    + currentProgress_percentage_str
                    + practiceStartDate_str
                    + practiceEndDate_str
            }
        },
        title: {
            text: '项目进度',
            left: 'center'
        },
        dataZoom: [
            {
                //区域缩放组件的类型为滑块，默认作用在x轴上
                type: 'slider',
                //区域缩放组件的过滤模式，weakFilter：在进行区域缩放时，允许图形的一部分在坐标系上(可见)，另一部分在坐标系外(隐藏)
                filterMode: 'weakFilter',
                showDataShadow: false,
                top: 400,
                height: 10,
                //区域缩放组件边框颜色
                borderColor: 'transparent',
                //区域缩放组件边框背景
                backgroundColor: '#e2e2e2',
                //区域缩放组件上的手柄的样式
                handleIcon: 'M10.7,11.9H9.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z', // jshint ignore:line
                //手柄大小
                handleSize: 20,
                //为手柄设置阴影效果
                handleStyle: {
                    shadowBlur: 6,
                    shadowOffsetX: 1,
                    shadowOffsetY: 2,
                    shadowColor: '#aaa'
                },
                labelFormatter: ''
            },
            {
                //区域缩放组件的类型为内置在坐标系中，默认作用在x轴的坐标系中
                type: 'inside',
                //区域缩放组件的过滤模式，weakFilter：在进行区域缩放时，允许图形的一部分在坐标系上(可见)，另一部分在坐标系外(隐藏)
                filterMode: 'weakFilter'
            }
        ],
        //图表底板
        grid: {
            height: 300
        },
        xAxis: {
            type: "time",//x轴类型为时间轴
            min: 1585670400000,//最小值为2020-04-01
            max: 1622304000000,//最大值为2021-05-30
            axisLabel: {
                interval: 0,//强制显示所有标签
            }

        },
        yAxis: {
            data: categories,
            axisTick: {
                alignWithLabel: true//保证刻度线和标签对齐，当boundaryGap为true的时候有效，不过boundaryGap默认就是true
            }
        },
        legend: {
            left: '70%',
            top: 10,
            data: ['计划工期', '实际工期']
        },
        series: [
            {
                type: 'custom',
                //使用自定义的图形元素
                renderItem: renderItem,
                name: '计划工期',
                itemStyle: {
                    //透明度
                    opacity: 0.8,
                    color: '#5574ff'
                },
                encode: {
                    //将维度1和维度2的数据映射到x轴
                    x: [1, 2],
                    //将维度0的数据映射到y轴
                    y: 0
                },
                data: data
            },
            //这个系列并没有太大作用，也没有给它设置data，只是为了通过这个系列，显示图例(legend)而已
            {
                type: 'custom',
                name: '实际工期',
                itemStyle: {
                    //透明度
                    opacity: 0.8,
                    color: '#55abc0'
                }
            }
        ]
    });
</script>
<!-- BEGIN LAYER JS -->
{#<script src="{% static 'layer-v3.1.1/layer-v3.1.1/layer/layer.js' %}"></script>#}
<script src="{% static 'layui/layui.js' %}"></script>
{#<script>#}
{#    !function () {#}
{#//页面一打开就执行，放入ready是为了layer所需配件（css、扩展模块）加载完毕#}
{#        layer.ready(function () {#}
{#            layer.open({#}
{#type: 2,#}
{#                title: '欢迎页',#}
{#                maxmin: true,#}
{#                area: ['800px', '500px'],#}
{#                content: "此页面分页展示项目进度:" + '</br>' + "1.甘特图" + '</br>' + "2.项目列表" + '</br>' + "甘特图起始。。，终止。。",#}
{#                end: function () {#}
{#                    layer.tips('Hi', '#about', {tips: 1})#}
{#                }#}
{#            });#}
{#        });#}
{##}
{##}
{#        $('#about').on('click', function () {#}
{#            layer.alert(layer.v + 'Project Progress!')#}
{#        });#}
{##}
{#        $('#about1').on('click', function () {#}
{#            layer.open({#}
{#                type: 2,#}
{#                title: '项目文件',#}
{#                maxmin: true,#}
{#                area: ['800px', '500px'],#}
{#                content: 'http://layer.layui.com/test/welcome.html',#}
{#                end: function () {#}
{#                    layer.tips('Hi', '#about', {tips: 1})#}
{#                }#}
{#            });#}
{#        });#}
{#    }();#}
{#</script>#}
<!-- BEGIN LAYUI UPLOADFILE JS -->
<script>
    layui.use('upload', function () {
        var $ = layui.jquery
            , upload = layui.upload;

        upload.render({
            elem: '#layui-upload'
            , url: '' //改成您自己的上传接口
            , accept: 'file' //普通文件
            , done: function (res) {
                layer.msg('上传成功');
                console.log(res);
            }
        });
    });
</script>
{# TODO 以上两个uploadfile优先选择layui的 #}
<!-- LAYUI CARD TAB SWITCH -->
<script>
    layui.use('element', function () {
        var $ = layui.jquery
            , element = layui.element; //Tab的切换功能，切换事件监听等，需要依赖element模块

        //触发事件
        var active = {
            tabAdd: function () {
                //新增一个Tab项
                element.tabAdd('demo', {
                    title: '新选项' + (Math.random() * 1000 | 0) //用于演示
                    , content: '内容' + (Math.random() * 1000 | 0)
                    , id: new Date().getTime() //实际使用一般是规定好的id，这里以时间戳模拟下
                })
            }
            , tabDelete: function (othis) {
                //删除指定Tab项
                element.tabDelete('demo', '44'); //删除：“商品管理”


                othis.addClass('layui-btn-disabled');
            }
            , tabChange: function () {
                //切换到指定Tab项
                element.tabChange('demo', '22'); //切换到：用户管理
            }
        };

        $('.site-demo-active').on('click', function () {
            var othis = $(this), type = othis.data('type');
            active[type] ? active[type].call(this, othis) : '';
        });

        //Hash地址的定位
        var layid = location.hash.replace(/^#test=/, '');
        element.tabChange('test', layid);

        element.on('tab(test)', function (elem) {
            location.hash = 'test=' + $(this).attr('lay-id');
        });

    });
</script>
<!-- DOWNLOAD JS -->
<script>
    //下载模板
    function downLoad() {
        var curWwwPath = window.document.location.href;
        var pathName = window.document.location.pathname;
        var pos = curWwwPath.indexOf(pathName);
        var localhostPath = curWwwPath.substring(0, pos);
        var projectName = pathName.substring(0, pathName.substr(1).indexOf('/') + 1);
        var url = localhostPath + projectName + "/xxTemplate/xxx.xls";
        window.open(url);
    }
</script>
<script type="text/javascript">
    $(document).ready(function () {
        $.ajaxSetup({
            data: {csrfmiddlewaretoken: "{{ csrf_token }}"},
        });
                $("#password_edit").submit(function () {
            var edit_password = $("#password_reset").val();
            var edit_password_twice = $('#password_reset_twice').val();
            $.ajax({
                type: 'POST',
                data: {
                    'edit_password': edit_password,
                    'edit_password_twice': edit_password_twice,
                },
                async: false,
                url: "{% url "reset" %}",
                cache: false,
                dataType: "json",
                success: function (data) {
                    window.location = '';
                    alert(data.message);

                },
                error: function () {
                    toastr.error('Error');

                }
            });
            return false;
        });
    });

</script>

</body>
</html>